@import com.gitlab.mbarberot.kriollo.generator.tests.coverage.JacocoMavenPluginModel
@param model: JacocoMavenPluginModel
<plugin>
                <groupId>${model.artifact.groupId}</groupId>
                <artifactId>${model.artifact.artifactId}</artifactId>
                <version>${model.artifact.version}</version>
                <executions>
                    <execution>
                        <id>coverage-prepare</id>
                        <goals>
                            <goal>prepare-agent</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>coverage-check</id>
                        <phase>verify</phase>
                        <goals>
                            <goal>check</goal>
                        </goals>
                        <configuration>
                            @if(model.exclusions.isNotEmpty())
                            <excludes>
                                @for(pattern in model.exclusions)
                                <exclude>${pattern}</exclude>
                                @endfor
                            </excludes>
                            @endif
                            <rules>
                                <rule>
                                    <element>BUNDLE</element>
                                    <limits>
                                        <limit>
                                            <counter>BRANCH</counter>
                                            <value>COVEREDRATIO</value>
                                            <minimum>${model.minimumBranchCoverage}</minimum>
                                        </limit>
                                        <limit>
                                            <counter>INSTRUCTION</counter>
                                            <value>COVEREDRATIO</value>
                                            <minimum>${model.minimumInstructionCoverage}</minimum>
                                        </limit>
                                        @if(model.maximumMissedClasses != null)
                                        <limit>
                                            <counter>CLASS</counter>
                                            <value>MISSEDCOUNT</value>
                                            <maximum>${model.maximumMissedClasses}</maximum>
                                        </limit>
                                        @endif
                                    </limits>
                                </rule>
                            </rules>
                        </configuration>
                    </execution>
                    <execution>
                        <id>coverage-report</id>
                        <phase>${model.reportPhase}</phase>
                        <goals>
                            <goal>report</goal>
                        </goals>
                        @if(model.exclusions.isNotEmpty())
                            <configuration>
                                <excludes>
                                    @for(pattern in model.exclusions)
                                        <exclude>${pattern}</exclude>
                                    @endfor
                                </excludes>
                            </configuration>
                        @endif
                    </execution>
                </executions>
            </plugin>